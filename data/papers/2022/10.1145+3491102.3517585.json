{
  "doi": "10.1145/3491102.3517585",
  "title": "Impact and User Perception of Sandwich Attacks in the DeFi Ecosystem",
  "published": "2022-04-29",
  "proctitle": "CHI '22: Proceedings of the 2022 CHI Conference on Human Factors in Computing Systems",
  "pages": "1-15",
  "year": 2022,
  "badges": [],
  "abstract": "Decentralized finance (DeFi) enables crypto-asset holders to conduct complex financial transactions, while maintaining control over their assets in the blockchain ecosystem. However, the transparency of blockchain networks and the open mechanism of DeFi applications also cause new security issues. In this paper, we focus on sandwich attacks, where attackers take advantage of the transaction confirmation delay and cause financial losses for victims. We evaluate the impact and investigate users\u2019 perceptions of sandwich attacks through a mix-method study. We find that due to users\u2019 lack of technical background and insufficient notifications from the markets, many users were not aware of the existence and the impact of sandwich attacks. They also had a limited understanding of how to resolve the security issue. Interestingly, users showed high tolerance for the impact of sandwich attacks on individuals and the ecosystem, despite potential financial losses. We discuss general implications for users, DeFi applications, and the community.",
  "authors": [
    {
      "name": "Ye Wang",
      "institution": "ETH Zurich, Switzerland",
      "img": "/pb-assets/icons/DOs/default-profile-1543932446943.svg",
      "acmid": "99660240026",
      "orcid": "missing"
    },
    {
      "name": "Patrick Zuest",
      "institution": "ETH Zurich, Switzerland",
      "img": "/pb-assets/icons/DOs/default-profile-1543932446943.svg",
      "acmid": "99660238969",
      "orcid": "missing"
    },
    {
      "name": "Yaxing Yao",
      "institution": "Department of Information Systems, University of Maryland Baltimore County, United States",
      "img": "/pb-assets/icons/DOs/default-profile-1543932446943.svg",
      "acmid": "99659131392",
      "orcid": "missing"
    },
    {
      "name": "Zhicong Lu",
      "institution": "Department of Computer Science, City University of Hong Kong, China",
      "img": "/do/10.1145/contrib-99659162049/rel-imgonly/photo.jpg",
      "acmid": "99659162049",
      "orcid": "0000-0002-7761-6351"
    },
    {
      "name": "Roger Wattenhofer",
      "institution": "Computer Engineering and Networks Laboratory, ETH Zurich, Switzerland",
      "img": "/pb-assets/icons/DOs/default-profile-1543932446943.svg",
      "acmid": "81100368559",
      "orcid": "missing"
    }
  ],
  "references": [
    {
      "text": "2020. Akropolis Incident: Root Cause Analysis. https://blog.peckshield.com/2020/11/13/akropolis/.",
      "doi": ""
    },
    {
      "text": "2020. Origin Dollar Incident: Root Cause Analysis. https://blog.peckshield.com/2020/11/17/ousd/.",
      "doi": ""
    },
    {
      "text": "2020. Uniswap/Lendf.Me Hacks: Root Cause and Loss Analysis. https://blog.peckshield.com/2020/04/19/erc777/.",
      "doi": ""
    },
    {
      "text": "2021. 5/8/2021: Rari Capital Ethereum Pool \u2014 Post-Mortem. https://medium.com/rari-capital/5-8-2021-rari-ethereum-pool-post-mortem-60aab6a6f8f9.",
      "doi": ""
    },
    {
      "text": "2021. (5/8/21) Rari Capital Exploit Timeline & Analysis. https://nipunp.medium.com/5-8-21-rari-capital-exploit-timeline-analysis-8beda31cbc1a.",
      "doi": ""
    },
    {
      "text": "2021. Alpha Homora V2. Available at: https://alphafinancelab.gitbook.io/alpha-homora-v2/.",
      "doi": ""
    },
    {
      "text": "2021. Binance Smart Chain DeFi project BurgerSwap hacked for $7 million. https://cryptoslate.com/binance-smart-chain-defi-project-burgerswap-hacked-for-7-million/.",
      "doi": ""
    },
    {
      "text": "2021. Burgerswap attack analysis. https://hiram.wang/burgerswap-attack-analysis/.",
      "doi": ""
    },
    {
      "text": "2021. Flashbots. https://medium.com/@danrobinson/ethereum-is-a-dark-forest-ecc5f0505dfff [Accessed May 25, 2021].",
      "doi": ""
    },
    {
      "text": "2021. Flashbots Transparency Report \u2014 April 2021. https://medium.com/flashbots/flashbots-transparency-report-april-2021-9fef4d8dde07",
      "doi": ""
    },
    {
      "text": "2021. The Furucombo Incident Analysis: Cascading Trust. https://blog.peckshield.com/2021/02/27/Furucombo/.",
      "doi": ""
    },
    {
      "text": "2021. Gross Value Locked (USD). https://debank.com/ranking/locked_value.",
      "doi": ""
    },
    {
      "text": "2021. PeckShield Brief Analysis of BurgerSwap Lightning Loan Attack. https://blockcast.cc/news/peckshield-brief-analysis-of-burgerswap-lightning-loan-attack-the-logic-behind-the-defi-protocol-is-more-important-than-the-code/.",
      "doi": ""
    },
    {
      "text": "2021. Rekt - Force - REKT. https://www.rekt.news/force-rekt/.",
      "doi": ""
    },
    {
      "text": "2021. Rekt - Furucombo - REKT. https://www.rekt.news/furucombo-rekt/.",
      "doi": ""
    },
    {
      "text": "2021. SushiSwap. Available at: https://https://sushi.com/.",
      "doi": ""
    },
    {
      "text": "Svetlana Abramova, Artemij Voskobojnikov, Konstantin Beznosov, and Rainer B\u00f6hme. 2021. Bits Under the Mattress: Understanding Different Risk Perceptions and Security Behaviors of Crypto-Asset Users. In Proceedings of the 2021 CHI Conference on Human Factors in Computing Systems. 1\u201319.",
      "doi": "10.1145/3411764.3445679"
    },
    {
      "text": "Hayden Adams, Noah Zinsmeister, and Dan Robinson. 2020. Uniswap v2 Core.Available at: https://uniswap. org/whitepaper.pdf.",
      "doi": ""
    },
    {
      "text": "Hayden Adams, Noah Zinsmeister, Moody Salem, River Keefer, and Dan Robinson. 2021. Uniswap v3 Core Whitepaper.",
      "doi": ""
    },
    {
      "text": "Guillermo Angeris, Alex Evans, and Tarun Chitra. 2021. A Note on Bundle Profit Maximization. (2021).",
      "doi": ""
    },
    {
      "text": "Massimo Bartoletti, James Hsin-yu Chiang, and Alberto Lluch-Lafuente. 2021. Maximizing Extractable Value from Automated Market Makers. arXiv preprint arXiv:2106.01870(2021).",
      "doi": ""
    },
    {
      "text": "George Bissias and Brian\u00a0Neil Levine. 2020. Bobtail: Improved Blockchain Security with Low-Variance Mining.. In NDSS.",
      "doi": ""
    },
    {
      "text": "Richard\u00a0E Boyatzis. 1998. Transforming qualitative information: Thematic analysis and code development. sage.",
      "doi": ""
    },
    {
      "text": "Ryan Browne. 2021. Hacker behind $600 million crypto heist returns final slice of stolen funds. Available at: https://www.cnbc.com/2021/08/23/poly-network-hacker-returns-remaining-cryptocurrency.html.",
      "doi": ""
    },
    {
      "text": "Vitalik Buterin 2014. A next-generation smart contract and decentralized application platform. white paper 3, 37 (2014).",
      "doi": ""
    },
    {
      "text": "Weili Chen, Tuo Zhang, Zhiguang Chen, Zibin Zheng, and Yutong Lu. 2020. Traveling the token world: A graph analysis of ethereum erc20 token ecosystem. In Proceedings of The Web Conference 2020. 1411\u20131421.",
      "doi": "10.1145/3366423.3380215"
    },
    {
      "text": "Philip Daian, Steven Goldfeder, Tyler Kell, Yunqi Li, Xueyuan Zhao, Iddo Bentov, Lorenz Breidenbach, and Ari Juels. 2020. Flash boys 2.0: Frontrunning in decentralized exchanges, miner extractable value, and consensus instability. In 2020 IEEE Symposium on Security and Privacy (SP). IEEE, 910\u2013927.",
      "doi": ""
    },
    {
      "text": "Christof Ferreira\u00a0Torres, Ramiro Camino, 2021. Frontrunner Jones and the Raiders of the Dark Forest: An Empirical Study of Frontrunning on the Ethereum Blockchain. In USENIX Security Symposium, Virtual 11-13 August 2021.",
      "doi": ""
    },
    {
      "text": "Michael Fr\u00f6hlich, Felix Gutjahr, and Florian Alt. 2020. Don\u2019t lose your coin! Investigating Security Practices of Cryptocurrency Users. In Proceedings of the 2020 ACM Designing Interactive Systems Conference. 1751\u20131763.",
      "doi": "10.1145/3357236.3395535"
    },
    {
      "text": "Xianyi Gao, Gradeigh\u00a0D Clark, and Janne Lindqvist. 2016. Of two minds, multiple addresses, and one ledger: characterizing opinions, knowledge, and perceptions of Bitcoin across users and non-users. In Proceedings of the 2016 CHI Conference on Human Factors in Computing Systems. 1656\u20131668.",
      "doi": "10.1145/2858036.2858049"
    },
    {
      "text": "Arthur Gervais, Ghassan\u00a0O Karame, Karl W\u00fcst, Vasileios Glykantzis, Hubert Ritzdorf, and Srdjan Capkun. 2016. On the security and performance of proof of work blockchains. In Proceedings of the 2016 ACM SIGSAC conference on computer and communications security. 3\u201316.",
      "doi": "10.1145/2976749.2978341"
    },
    {
      "text": "Larry Harris. 2003. Trading and exchanges: Market microstructure for practitioners. OUP USA.",
      "doi": ""
    },
    {
      "text": "Campbell\u00a0R Harvey, Ashwin Ramachandran, and Joey Santoro. 2021. DeFi and the Future of Finance. John Wiley & Sons.",
      "doi": ""
    },
    {
      "text": "Ethan Heilman, Alison Kendler, Aviv Zohar, and Sharon Goldberg. 2015. Eclipse attacks on bitcoin\u2019s peer-to-peer network. In 24th {USENIX} Security Symposium ({USENIX} Security 15). 129\u2013144.",
      "doi": ""
    },
    {
      "text": "Charlie Hou, Mingxun Zhou, Yan Ji, Phil Daian, Florian Tramer, Giulia Fanti, and Ari Juels. 2021. SquirRL: Automating attack analysis on blockchain incentive mechanisms with deep reinforcement learning. In NDSS.",
      "doi": ""
    },
    {
      "text": "Mahimna Kelkar, Fan Zhang, Steven Goldfeder, and Ari Juels. 2020. Order-fairness for byzantine consensus. In Annual International Cryptology Conference. Springer, 451\u2013480.",
      "doi": "10.1007/978-3-030-56877-1_16"
    },
    {
      "text": "Irni\u00a0Eliana Khairuddin and Corina Sas. 2019. An Exploration of Bitcoin mining practices: Miners\u2019 trust challenges and motivations. In Proceedings of the 2019 CHI Conference on Human Factors in Computing Systems. 1\u201313.",
      "doi": "10.1145/3290605.3300859"
    },
    {
      "text": "Irni\u00a0Eliana Khairuddin, Corina Sas, Sarah Clinch, and Nigel Davies. 2016. Exploring motivations for bitcoin technology usage. In Proceedings of the 2016 CHI Conference Extended Abstracts on Human Factors in Computing Systems. 2872\u20132878.",
      "doi": "10.1145/2851581.2892500"
    },
    {
      "text": "Richard Lawler. 2021. Someone stole $120 million in crypto by hacking a DeFi website. Available at: https://www.theverge.com/2021/12/2/22814849/badgerdao-defi-120-million-hack-bitcoin-ethereum.",
      "doi": ""
    },
    {
      "text": "Robert Leshner and Geoffrey Hayes. 2019. Compound Finance Whitepaper.",
      "doi": ""
    },
    {
      "text": "Bowen Liu, Pawel Szalachowski, and Jianying Zhou. 2020. A first look into defi oracles. arXiv preprint arXiv:2005.04377(2020).",
      "doi": ""
    },
    {
      "text": "Satoshi Nakamoto. 2008. Bitcoin: A peer-to-peer electronic cash system. Decentralized Business Review(2008), 21260.",
      "doi": ""
    },
    {
      "text": "Daniel Perez and Ben Livshits. 2021. Smart contract vulnerabilities: Vulnerable does not imply exploited. In 30th {USENIX} Security Symposium ({USENIX} Security 21).",
      "doi": ""
    },
    {
      "text": "Anton Permenev, Dimitar Dimitrov, Petar Tsankov, Dana Drachsler-Cohen, and Martin Vechev. 2020. Verx: Safety verification of smart contracts. In 2020 IEEE Symposium on Security and Privacy (SP). IEEE, 1661\u20131677.",
      "doi": ""
    },
    {
      "text": "Chris Piatt, Jeffrey Quesnelle, and Caleb Sheridan. 2021. Eden Network. (2021).",
      "doi": ""
    },
    {
      "text": "Kaihua Qin, Liyi Zhou, Yaroslav Afonin, Ludovico Lazzaretti, and Arthur Gervais. 2021. CeFi vs. DeFi\u2013Comparing Centralized to Decentralized Finance. arXiv preprint arXiv:2106.08157(2021).",
      "doi": ""
    },
    {
      "text": "Kaihua Qin, Liyi Zhou, and Arthur Gervais. 2021. Quantifying Blockchain Extractable Value: How dark is the forest?arXiv preprint arXiv:2101.05511(2021).",
      "doi": ""
    },
    {
      "text": "Kaihua Qin, Liyi Zhou, Benjamin Livshits, and Arthur Gervais. 2021. Attacking the DeFi Ecosystem with Flash Loans for Fun and Profit. In International Conference on Financial Cryptography and Data Security. Springer.",
      "doi": ""
    },
    {
      "text": "Michael Rodler, Wenting Li, Ghassan\u00a0O Karame, and Lucas Davi. 2021. EVMPatch: timely and automated patching of ethereum smart contracts. In 30th {USENIX} Security Symposium ({USENIX} Security 21).",
      "doi": ""
    },
    {
      "text": "Tim Roughgarden. 2021. Transaction Fee Mechanism Design. In Proceedings of the 22nd ACM Conference on Economics and Computation. 792.",
      "doi": "10.1145/3465456.3467591"
    },
    {
      "text": "Corina Sas and Irni\u00a0Eliana Khairuddin. 2017. Design for trust: An exploration of the challenges and opportunities of bitcoin users. In Proceedings of the 2017 CHI Conference on Human Factors in Computing Systems. 6499\u20136510.",
      "doi": "10.1145/3025453.3025886"
    },
    {
      "text": "Fabian Sch\u00e4r. 2021. Decentralized finance: On blockchain-and smart contract-based financial markets. FRB of St. Louis Review(2021).",
      "doi": ""
    },
    {
      "text": "Clara Schneidewind, Ilya Grishchenko, Markus Scherer, and Matteo Maffei. 2020. ethor: Practical and provably sound static analysis of ethereum smart contracts. In Proceedings of the 2020 ACM SIGSAC Conference on Computer and Communications Security. 621\u2013640.",
      "doi": "10.1145/3372297.3417250"
    },
    {
      "text": "Yaakov Sokolik and Ori Rottenstreich. 2020. Age-aware Fairness in Blockchain Transaction Ordering. In 2020 IEEE/ACM 28th International Symposium on Quality of Service (IWQoS). IEEE, 1\u20139.",
      "doi": ""
    },
    {
      "text": "Cryptopedia Staff. 2021. What Was The DAO?Available at: https://www.gemini.com/cryptopedia/the-dao-hack-makerdao.",
      "doi": ""
    },
    {
      "text": "Liya Su, Xinyue Shen, Xiangyu Du, Xiaojing Liao, XiaoFeng Wang, Luyi Xing, and Baoxu Liu. 2021. Evil Under the Sun: Understanding and Discovering Attacks on Ethereum Decentralized Applications. In 30th {USENIX} Security Symposium ({USENIX} Security 21).",
      "doi": ""
    },
    {
      "text": "Nick Szabo. 1996. Smart contracts: building blocks for digital markets. EXTROPY: The Journal of Transhumanist Thought,(16) 18, 2(1996).",
      "doi": ""
    },
    {
      "text": "Artemij Voskobojnikov, Borke Obada-Obieh, Yue Huang, and Konstantin Beznosov. 2020. Surviving the cryptojungle: Perception and management of risk among North American cryptocurrency (non) users. In International Conference on Financial Cryptography and Data Security. Springer, 595\u2013614.",
      "doi": "10.1007/978-3-030-51280-4_32"
    },
    {
      "text": "Artemij Voskobojnikov, Oliver Wiese, Masoud Mehrabi\u00a0Koushki, Volker Roth, and Konstantin Beznosov. 2021. The U in Crypto Stands for Usable: An Empirical Study of User Experience with Mobile Cryptocurrency Wallets. In Proceedings of the 2021 CHI Conference on Human Factors in Computing Systems. 1\u201314.",
      "doi": "10.1145/3411764.3445407"
    },
    {
      "text": "Ye Wang, Yan Chen, Shuiguang Deng, and Roger Wattenhofer. 2021. Cyclic Arbitrage in Decentralized Exchange Markets. Available at SSRN 3834535(2021).",
      "doi": ""
    },
    {
      "text": "Sam\u00a0M Werner, Daniel Perez, Lewis Gudgeon, Ariah Klages-Mundt, Dominik Harz, and William\u00a0J Knottenbelt. 2021. Sok: Decentralized finance (defi). arXiv preprint arXiv:2101.08778(2021).",
      "doi": ""
    },
    {
      "text": "Gavin Wood 2014. Ethereum: A secure decentralised generalised transaction ledger. Ethereum project yellow paper 151, 2014 (2014), 1\u201332.",
      "doi": ""
    },
    {
      "text": "Siwei Wu, Dabao Wang, Jianting He, Yajin Zhou, Lei Wu, Xingliang Yuan, Qinming He, and Kui Ren. 2021. DeFiRanger: Detecting Price Manipulation Attacks on DeFi Applications. arXiv preprint arXiv:2104.15068(2021).",
      "doi": ""
    },
    {
      "text": "Yaxing Yao, Yun Huang, and Yang Wang. 2019. Unpacking People\u2019s Understandings of Bluetooth Beacon Systems-A Location-Based IoT Technology. In Proceedings of the 52nd Hawaii International Conference on System Sciences.",
      "doi": ""
    },
    {
      "text": "Akif Y\u00fcksel. 2021. Mitigating sandwich attacks in Kyber DMM. (2021).",
      "doi": ""
    },
    {
      "text": "Ren Zhang and Bart Preneel. 2019. Lay down the common metrics: Evaluating proof-of-work consensus protocols\u2019 security. In 2019 IEEE Symposium on Security and Privacy (SP). IEEE, 175\u2013192.",
      "doi": ""
    },
    {
      "text": "Liyi Zhou, Kaihua Qin, Antoine Cully, Benjamin Livshits, and Arthur Gervais. 2021. On the just-in-time discovery of profit-generating transactions in defi protocols. arXiv preprint arXiv:2103.02228(2021).",
      "doi": ""
    },
    {
      "text": "Liyi Zhou, Kaihua Qin, Christof Ferreira\u00a0Torres, Arthur Gervais, 2021. High-Frequency Trading on Decentralized On-Chain Exchanges. In IEEE Symposium on Security and Privacy, 23-27 May 2021.",
      "doi": ""
    },
    {
      "text": "Liyi Zhou, Kaihua Qin, and Arthur Gervais. 2021. A2MM: Mitigating Frontrunning, Transaction Reordering and Consensus Instability in Decentralized Exchanges. arXiv preprint arXiv:2106.07371(2021).",
      "doi": ""
    }
  ]
}